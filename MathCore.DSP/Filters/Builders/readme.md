# Builders фильтров

Директория содержит набор "строителей" (Builder-типы) для создания дискретных цифровых фильтров различных семейств (Баттерворта, Чебышева, эллиптических и простых RC) с параметризацией через удобный fluent/record‑подход.

## Назначение
Builder-структуры инкапсулируют параметры проектирования фильтра (тип полосы пропускания, частоты, коэффициенты усиления/затухания, порядок и допуски) и подготавливают экземпляры конечных фильтров (`Filter`) через метод `Create()` или неявное преобразование оператора `implicit`.

## Состав
- `FrequencyPassType` – перечисление типов полосы: ФНЧ, ФВЧ, ППФ, ПЗФ
- Универсальные ref builders (параметрические без метода создания в текущей версии):
  - `ButterworthBuilder`
  - `ChebyshevBuilder`
  - `EllipticBuilder`
- Специализированные builders нижних частот:
  - `LowPassBuilder` – корневой строитель; производные:
    - `LowPassButterworthBuilder`
    - `LowPassChebyshevBuilder`
    - `LowPassEllipticBuilder`
    - `LowPassRCBuilder` (RC-фильтр первого порядка)
    - `LowPassRCExponentialBuilder` (вариант с экспоненциальной аппроксимацией)
- Специализированные builders верхних частот:
  - `HighPassBuilder` – корневой строитель; производные:
    - `HighPassButterworthBuilder`
    - `HighPassChebyshevBuilder`
- Заготовки полосных фильтров:
  - `BandPassBuilder`
  - `BandStopBuilder`

## Общие параметры
Большинство builders оперируют:
- `dt` – период дискретизации (сек)
- `fd` – частота дискретизации (Гц) (взаимосвязана с `dt`)
- `fp`, `fs` – граничные частоты пропускания / заграждения
- `Gp`, `Gs` – коэффициенты передачи в полосах (линейные, не в дБ)
- `Rp`, `Rs` – неравномерность (ripples) / затухание (дБ)
- `Order` – желаемый порядок (если требуется принудительно)

## Использование
### Пример: ФНЧ Баттерворта
```csharp
var dt = 1 / 8000d; // период дискретизации
var builder = new LowPassBuilder(dt)
    .Butterworth(fs: 1500, fp: 1000, Gp: 1, Gs: 0.1);

Filter filter = builder; // неявное преобразование
// Или явное создание:
var bw_lp = builder.Create();
```
### Пример: ФВЧ Чебышева
```csharp
var dt = 1 / 44100d;
var cheb_hp_builder = new HighPassBuilder(dt)
    .Chebyshev(fs: 500, fp: 1000, Gp: 1, Gs: 0.05);

Filter cheb_hp = cheb_hp_builder; // implicit
```
### Пример: RC фильтр нижних частот
```csharp
var dt = 1 / 1000d;
var rc_builder = new LowPassBuilder(dt).RC(f0: 10);
Filter rc = rc_builder; // создание RC фильтра
```
### Пример: RC экспоненциальный
```csharp
var dt = 1 / 1000d;
var rc_exp_builder = new LowPassBuilder(dt).RCExponential(f0: 10);
Filter rc_exp = rc_exp_builder;
```

## Особенности
- Запись через `record struct` облегчает иммутабельность и копирование с изменением (`with`)
- Неявные операторы преобразования упрощают получение готового фильтра
- Для универсальных builders (`ButterworthBuilder`, `ChebyshevBuilder`, `EllipticBuilder`) далее может быть расширена функциональность методами расчёта и генерации коэффициентов

## План расширений
1. Реализация методов `Create()` для универсальных builders с автоматическим подбором порядка по допускам
2. Добавление полосных (ППФ/ПЗФ) вариантов с расчётом преобразования частот
3. Включение генерации АЧХ/ФЧХ/Импульсной характеристики прямо из builder

## Быстрый старт
1. Выберите базовый builder по типу полосы (`LowPassBuilder`, `HighPassBuilder` и т.д.)
2. Вызовите метод семейства фильтра (`Butterworth`, `Chebyshev`, `RC` ...)
3. Неявно преобразуйте к `Filter` или вызовите `Create()`
4. Используйте полученный фильтр для обработки выборок (методы исходного класса `Filter`)

---
При добавлении новых типов фильтров выдерживайте единый стиль: минимализм, иммутабельность параметров, русские XML‑комментарии и неявный оператор преобразования к `Filter`.
